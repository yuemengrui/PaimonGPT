(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6191],{57462:function(t,e,i){Promise.resolve().then(i.bind(i,12746))},65328:function(t,e,i){"use strict";i.d(e,{Aq:function(){return o},JR:function(){return d},KD:function(){return u},PW:function(){return p},YC:function(){return s},ZF:function(){return r},dJ:function(){return a},fQ:function(){return l},pm:function(){return c},sr:function(){return h}});var n=i(13650);async function o(){let t={method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")}},e=await (0,n.d)("/ai/app/list",t);return e?e.list:[]}async function a(t){let e={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({app_id:t})};return await (0,n.d)("/ai/app/info",e)}async function s(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],s={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({app_id:t,name:e,description:i,llm_name:o,kbs:a})};return await (0,n.d)("/ai/app/info/modify",s)}async function r(t){let e={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({app_id:t})};return await (0,n.d)("/ai/app/create/from_appstore",e)}async function l(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({name:t,llm_name:e,kbs:i})};return await (0,n.d)("/ai/app/create",o)}async function c(t){let e={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({app_id:t})};return await (0,n.d)("/ai/app/delete",e)}async function u(t){let e={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({app_id:t})},i=await (0,n.d)("/ai/app/chat/list",e);return i?i.list:[]}async function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({app_id:t,name:e})};return await (0,n.d)("/ai/app/chat/create",i)}async function p(t){let e={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({chat_id:t})};return await (0,n.d)("/ai/app/chat/delete",e)}async function h(t){let e={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({chat_id:t})},i=await (0,n.d)("/ai/app/chat/message/list",e);return i?i.list:[]}},18039:function(t,e,i){"use strict";i.d(e,{B:function(){return o}});var n=i(13650);async function o(){let t={method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")}},e=await (0,n.d)("/ai/llm/list",t);return(console.log("llm list response",e),e)?e.data:[]}},13650:function(t,e,i){"use strict";async function n(t,e){let i=await fetch(t,e);return await i.json()}i.d(e,{d:function(){return n}})},72194:function(t,e,i){"use strict";i.d(e,{Bv:function(){return a},D6:function(){return u},If:function(){return r},SE:function(){return c},Yk:function(){return o},xs:function(){return l},zM:function(){return s}});var n=i(13650);async function o(){let t={method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")}},e=await (0,n.d)("/ai/kb/list",t);return(console.log("response",e),e)?e.list:[]}async function a(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({name:t,embedding_model:e,description:i})};return await (0,n.d)("/ai/kb/create",o)}async function s(t){let e={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({kb_id:t})};return await (0,n.d)("/ai/kb/delete",e)}async function r(t){let e={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({kb_id:t})},i=await (0,n.d)("/ai/kb/file/list",e);return(console.log("response",i),i)?i.list:[]}async function l(t,e,i){let o={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({kb_id:t,method_id:e,files:i})};console.log("response",await (0,n.d)("/ai/kb/file/import",o))}async function c(t){let e={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({file_id:t})},i=await (0,n.d)("/ai/kb/file/chunks",e);return(console.log("response",i),i)?i.list:[]}async function u(t){let e={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({data_id:t})};return await (0,n.d)("/ai/kb/file/delete",e)}},12746:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return T}});var n=i(57437),o=i(2265),a=i(65328),s=i(18039),r=i(72194),l=i(73623),c=i(98987),u=i(24033),d=i(19241),p=i(36468),h=i(30954),m=i(76526),f=i(72647),x=i(3391),g=i(81629),j=i(4159),y=i(88610),z=i(71504);function S(t){let{app:e,getAppList:i}=t,s=(0,u.useRouter)(),r=(0,l.p)(),[S,b]=(0,o.useState)(!1);async function v(){let t=await (0,a.pm)(e.id);t?t.errmsg?r({title:"失败",description:t.errmsg,status:"error",position:"top",duration:2e3}):r({title:"成功",status:"success",position:"top",duration:2e3}):r({title:"失败",status:"error",position:"top",duration:2e3}),i(),b(!1)}return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{onClick:()=>{s.push("/app/chat?appid=".concat(e.id))},className:"relative col-span-1 bg-white border-2 border-solid border-transparent rounded-lg shadow-xs min-h-[160px] flex flex-col transition-all duration-300 ease-in-out cursor-pointer hover:shadow-2xl group",children:[(0,n.jsx)("div",{onClick:t=>{t.stopPropagation(),b(!0)},className:"absolute right-2 top-2 hover:text-red-600 hidden group-hover:block",children:(0,n.jsx)(d.qy0,{})}),(0,n.jsxs)("div",{className:"flex pt-[14px] px-[14px] pb-3 h-[66px] items-center gap-3 grow-0 shrink-0",children:[(0,n.jsx)(c.Z,{}),(0,n.jsx)("div",{className:"relative h-8 text-sm font-medium leading-8 grow",children:(0,n.jsx)("div",{className:"absolute top-0 left-2 w-full h-full overflow-hidden text-ellipsis whitespace-nowrap",children:e.name})})]}),(0,n.jsx)("div",{className:"mb-3 px-[14px] h-9 text-xs leading-normal text-gray-500 line-clamp-2",children:e.description}),!e.is_appstore&&(0,n.jsx)("div",{className:"flex items-center flex-wrap min-h-[24px] px-2 mt-4 text-xs",children:"自建应用"}),(0,n.jsx)("div",{onClick:t=>{t.stopPropagation(),s.push("/app/settings?appid=".concat(e.id))},className:"absolute right-2 bottom-2  hover:text-red-600 hidden group-hover:block",children:(0,n.jsx)(p.Fuo,{})})]}),S&&(0,n.jsxs)(h.u_,{isOpen:!0,onClose:()=>b(!1),children:[(0,n.jsx)(m.Z,{}),(0,n.jsxs)(f.h,{children:[(0,n.jsxs)(x.x,{children:["确认删除 ",(0,n.jsx)("span",{className:"text-red-600",children:e.name})," 吗？"]}),(0,n.jsx)(g.o,{}),(0,n.jsx)(j.f,{children:(0,n.jsx)("div",{className:"text-center",children:"删除后数据将无法恢复"})}),(0,n.jsx)(y.m,{children:(0,n.jsx)(z.z,{border:"1px",borderColor:"gray.200",onClick:v,children:"确认删除"})})]})]})]})}var b=i(51091),v=i(56641),w=i(93309),A=i(74261),N=i(9304);function T(){let t=(0,l.p)(),[e,i]=(0,o.useState)([]),[u,d]=(0,o.useState)([]),[p,T]=(0,o.useState)([]),[C,O]=(0,o.useState)(!1),[k,Z]=(0,o.useState)(""),[_,I]=(0,o.useState)(null),[P,J]=(0,o.useState)([]);async function E(){i(await (0,a.Aq)())}function F(){O(!1),Z(""),I(null),J([])}async function G(){if(k&&_){let e=[];P.length>0&&P.map(t=>{let i=p.filter(e=>e.name===t)[0];e.push(i)});let i=await (0,a.fQ)(k,_,e);i?i.errmsg?t({title:"失败",description:i.errmsg,status:"error",position:"top",duration:2e3}):t({title:"成功",status:"success",position:"top",duration:2e3}):t({title:"失败",status:"error",position:"top",duration:2e3}),F(),E()}else t({title:"请填写应用名称和选择模型",status:"error",position:"top",duration:2e3})}return(0,o.useEffect)(()=>{E()},[]),(0,o.useEffect)(()=>{(async function(){let t=await (0,s.B)();t&&t.length>0&&d(t);let e=await (0,r.Yk)();e&&e.length>0&&T(e)})()},[C]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"grid content-start grid-cols-1 gap-4 px-12 pt-8 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 grow shrink-0",children:[(0,n.jsxs)("div",{className:"col-span-1 border-2 border-solid border-transparent rounded-lg shadow-xs min-h-[160px] flex flex-col transition-all duration-200 ease-in-out cursor-pointer outline outline-1 outline-gray-200 -outline-offset-1 bg-gray-200 hover:shadow-lg hover:bg-white",onClick:function(){e.length>=10?t({title:"只允许创建10个应用",status:"error",position:"top",duration:2e3}):O(!0)},children:[(0,n.jsxs)("div",{className:"flex pt-[14px] px-[14px] pb-3 h-[66px] items-center gap-3 grow-0 shrink-0",children:[(0,n.jsx)(c.Z,{name:"Add"}),(0,n.jsx)("div",{className:"relative h-8 text-sm font-medium leading-8 grow transition-colors duration-200 ease-in-out",children:"创建应用"})]}),(0,n.jsx)("div",{className:"mb-3 px-[14px] h-9 text-xs leading-normal text-gray-500 line-clamp-2",children:"tips: 创建应用前可以先去商城页面逛逛，说不定能发现你需要的应用！"})]}),e.map(t=>(0,n.jsx)(S,{app:t,getAppList:E},t.id))]}),C&&(0,n.jsxs)(h.u_,{isOpen:!0,onClose:F,children:[(0,n.jsx)(m.Z,{}),(0,n.jsxs)(f.h,{children:[(0,n.jsx)(x.x,{children:"创建新应用"}),(0,n.jsx)(g.o,{}),(0,n.jsxs)(j.f,{children:[(0,n.jsx)("div",{children:"应用名称"}),(0,n.jsx)(b.I,{value:k,onChange:t=>{Z(t.target.value)},placeholder:"请输入应用名称..."}),(0,n.jsx)("div",{children:"请选择模型"}),(0,n.jsx)(v.P,{onChange:t=>{I(t.target.value)},placeholder:"请选择模型",children:u.map(t=>(0,n.jsx)("option",{children:t.model_name},t.model_name))}),(0,n.jsx)("div",{children:"请选择知识库，可不选，可多选"}),(0,n.jsx)(w.c,{onChange:t=>J(t),children:(0,n.jsx)(A.K,{spacing:5,direction:"column",children:p.map(t=>(0,n.jsx)(N.X,{value:t.name,children:t.name},t.id))})})]}),(0,n.jsx)(y.m,{children:(0,n.jsx)(z.z,{border:"1px",borderColor:"gray.200",onClick:G,children:"确认"})})]})]})]})}},98987:function(t,e,i){"use strict";i.d(e,{Z:function(){return O}});var n=i(57437),o=i(28498),a=i(25911),s=i(94213),r=i(5690),l=i(33955),c=i(70818),u=i(97544),d=i(43302),p=i(55432),h=i(30114),m=i(3297),f=i(67771),x=i(67349),g=i(68665),j=i(87615),y=i(19868),z=i(78693),S=i(58207),b=i(76965),v=i(48994),w=i(41523),A=i(8136),N=i(7061),T=i(46858),C=i(31266);function O(t){let{name:e=null}=t,i={Add:(0,n.jsx)(o.Z,{theme:"outline",size:"24",fill:"#adabab"})},O=[{icon:(0,n.jsx)(a.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(s.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(r.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(l.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(c.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(u.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(d.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(p.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(h.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(m.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(f.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(x.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(g.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(j.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(y.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(z.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(S.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(b.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(v.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(w.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(A.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(N.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(T.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(C.Z,{theme:"outline",size:"24",fill:"#333"})}];return e?i[e]:O[Math.floor(Math.random()*O.length)].icon}i(76131)},51091:function(t,e,i){"use strict";i.d(e,{I:function(){return u}});var n=i(6036),o=i(58250),a=i(89839),s=i(50446),r=i(82184),l=i(16465),c=i(57437),u=(0,o.G)(function(t,e){let{htmlSize:i,...o}=t,u=(0,a.jC)("Input",o),d=(0,s.Lr)(o),p=(0,n.Y)(d),h=(0,l.cx)("chakra-input",t.className);return(0,c.jsx)(r.m.input,{size:i,...p,__css:u.field,ref:e,className:h})});u.displayName="Input",u.id="Input"}},function(t){t.O(0,[9929,3190,6161,8071,3995,4486,2971,4938,1744],function(){return t(t.s=57462)}),_N_E=t.O()}]);