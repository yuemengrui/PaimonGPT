(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3080],{43344:function(e,t,i){Promise.resolve().then(i.bind(i,45079))},13650:function(e,t,i){"use strict";async function n(e,t){let i=await fetch(e,t);return await i.json()}i.d(t,{d:function(){return n}})},72194:function(e,t,i){"use strict";i.d(t,{Bv:function(){return o},D6:function(){return c},If:function(){return r},SE:function(){return d},Yk:function(){return l},xs:function(){return a},zM:function(){return s}});var n=i(13650);async function l(){let e={method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")}},t=await (0,n.d)("/ai/kb/list",e);return(console.log("response",t),t)?t.list:[]}async function o(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",l={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({name:e,embedding_model:t,description:i})};return await (0,n.d)("/ai/kb/create",l)}async function s(e){let t={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({kb_id:e})};return await (0,n.d)("/ai/kb/delete",t)}async function r(e){let t={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({kb_id:e})},i=await (0,n.d)("/ai/kb/file/list",t);return(console.log("response",i),i)?i.list:[]}async function a(e,t,i){let l={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({kb_id:e,method_id:t,files:i})};console.log("response",await (0,n.d)("/ai/kb/file/import",l))}async function d(e){let t={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({file_id:e})},i=await (0,n.d)("/ai/kb/file/chunks",t);return(console.log("response",i),i)?i.list:[]}async function c(e){let t={method:"POST",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")},body:JSON.stringify({data_id:e})};return await (0,n.d)("/ai/kb/file/delete",t)}},45079:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return k}});var n=i(57437),l=i(2265),o=i(72194),s=i(73623),r=i(98987),a=i(24033),d=i(19241),c=i(30954),u=i(76526),h=i(72647),f=i(3391),m=i(81629),p=i(4159),x=i(88610),j=i(71504);function g(e){let{kb:t,getKBList:i}=e,g=(0,a.useRouter)(),v=(0,s.p)(),[b,y]=(0,l.useState)(!1);async function z(){let e=await (0,o.zM)(t.id);e?e.errmsg?v({title:"失败",description:e.errmsg,status:"error",position:"top",duration:2e3}):v({title:"成功",status:"success",position:"top",duration:2e3}):v({title:"失败",status:"error",position:"top",duration:2e3}),i(),y(!1)}return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{onClick:()=>{g.push("/kb/info?kb_id=".concat(t.id,"&kb_name=").concat(t.name))},className:"relative col-span-1 bg-white border-2 border-solid border-transparent rounded-lg shadow-xs min-h-[160px] flex flex-col transition-all duration-300 ease-in-out cursor-pointer hover:shadow-2xl group",children:[(0,n.jsx)("div",{onClick:e=>{e.stopPropagation(),y(!0)},className:"absolute right-2 top-2 hover:text-red-600 hidden group-hover:block",children:(0,n.jsx)(d.qy0,{})}),(0,n.jsxs)("div",{className:"flex pt-[14px] px-[14px] pb-3 h-[66px] items-center gap-3 grow-0 shrink-0",children:[(0,n.jsx)(r.Z,{}),(0,n.jsx)("div",{className:"relative h-8 text-sm font-medium leading-8 grow",children:(0,n.jsx)("div",{className:"absolute top-0 left-2 w-full h-full overflow-hidden text-ellipsis whitespace-nowrap",children:t.name})})]}),(0,n.jsx)("div",{className:"mb-3 px-[14px] h-9 text-xs leading-normal text-gray-500 line-clamp-2",children:t.description})]}),b&&(0,n.jsxs)(c.u_,{isOpen:!0,onClose:()=>y(!1),children:[(0,n.jsx)(u.Z,{}),(0,n.jsxs)(h.h,{children:[(0,n.jsxs)(f.x,{children:["确认删除 ",(0,n.jsx)("span",{className:"text-red-600",children:t.name})," 吗？"]}),(0,n.jsx)(m.o,{}),(0,n.jsx)(p.f,{children:(0,n.jsx)("div",{className:"text-center",children:"删除后数据将无法恢复"})}),(0,n.jsx)(x.m,{children:(0,n.jsx)(j.z,{border:"1px",borderColor:"gray.200",onClick:z,children:"确认删除"})})]})]})]})}var v=i(51091),b=i(56641),y=i(13650);async function z(){let e={method:"GET",headers:{"Content-Type":"application/json",Authorization:localStorage.getItem("Authorization")}},t=await (0,y.d)("/ai/embedding/model/list",e);return(console.log("response",t),t)?t.data:[]}function k(){let e=(0,s.p)(),[t,i]=(0,l.useState)([]),[a,d]=(0,l.useState)([]),[y,k]=(0,l.useState)(!1),[_,C]=(0,l.useState)(""),[S,N]=(0,l.useState)(null);async function w(){let e=await (0,o.Yk)();e&&e.length&&i(e)}function Z(){k(!1),C(""),d([]),N(null)}async function I(){if(_&&S){let t=await (0,o.Bv)(_,S);t?t.errmsg?e({title:"失败",description:t.errmsg,status:"error",position:"top",duration:2e3}):e({title:"成功",status:"success",position:"top",duration:2e3}):e({title:"失败",status:"error",position:"top",duration:2e3}),Z(),w()}else e({title:"知识库名称和embedding模型不能为空",status:"error",position:"top",duration:2e3})}return(0,l.useEffect)(()=>{w()},[]),(0,l.useEffect)(()=>{(async function(){let e=await z();e&&e.length&&d(e)})()},[y]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"grid content-start grid-cols-1 gap-4 px-12 pt-8 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 grow shrink-0",children:[(0,n.jsx)("div",{className:"col-span-1 border-2 border-solid border-transparent rounded-lg shadow-xs min-h-[160px] flex flex-col transition-all duration-200 ease-in-out cursor-pointer outline outline-1 outline-gray-200 -outline-offset-1 bg-gray-200 hover:shadow-lg hover:bg-white",onClick:function(){k(!0)},children:(0,n.jsxs)("div",{className:"flex pt-[14px] px-[14px] pb-3 h-[66px] items-center gap-3 grow-0 shrink-0",children:[(0,n.jsx)(r.Z,{name:"Add"}),(0,n.jsx)("div",{className:"relative h-8 text-sm font-medium leading-8 grow transition-colors duration-200 ease-in-out",children:"创建知识库"})]})}),t.map(e=>(0,n.jsx)(g,{kb:e,getKBList:w},e.id))]}),y&&(0,n.jsxs)(c.u_,{isOpen:!0,onClose:Z,children:[(0,n.jsx)(u.Z,{}),(0,n.jsxs)(h.h,{children:[(0,n.jsx)(f.x,{children:"创建知识库"}),(0,n.jsx)(m.o,{}),(0,n.jsxs)(p.f,{children:[(0,n.jsx)("div",{children:"知识库名称"}),(0,n.jsx)(v.I,{value:_,onChange:e=>{C(e.target.value)},placeholder:"请输入知识库名称..."}),(0,n.jsx)("div",{children:"请选择Embedding模型"}),(0,n.jsx)(b.P,{onChange:e=>{N(e.target.value)},placeholder:"请选择Embedding模型",children:a.map(e=>(0,n.jsx)("option",{children:e.model_name},e.model_name))})]}),(0,n.jsx)(x.m,{children:(0,n.jsx)(j.z,{border:"1px",borderColor:"gray.200",onClick:I,children:"确认"})})]})]})]})}},98987:function(e,t,i){"use strict";i.d(t,{Z:function(){return Z}});var n=i(57437),l=i(28498),o=i(25911),s=i(94213),r=i(5690),a=i(33955),d=i(70818),c=i(97544),u=i(43302),h=i(55432),f=i(30114),m=i(3297),p=i(67771),x=i(67349),j=i(68665),g=i(87615),v=i(19868),b=i(78693),y=i(58207),z=i(76965),k=i(48994),_=i(41523),C=i(8136),S=i(7061),N=i(46858),w=i(31266);function Z(e){let{name:t=null}=e,i={Add:(0,n.jsx)(l.Z,{theme:"outline",size:"24",fill:"#adabab"})},Z=[{icon:(0,n.jsx)(o.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(s.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(r.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(a.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(d.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(c.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(u.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(h.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(f.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(m.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(p.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(x.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(j.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(g.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(v.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(b.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(y.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(z.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(k.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(_.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(C.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(S.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(N.Z,{theme:"outline",size:"24",fill:"#333"})},{icon:(0,n.jsx)(w.Z,{theme:"outline",size:"24",fill:"#333"})}];return t?i[t]:Z[Math.floor(Math.random()*Z.length)].icon}i(76131)},6036:function(e,t,i){"use strict";i.d(t,{K:function(){return s},Y:function(){return o}});var n=i(27100),l=i(16465);function o(e){let{isDisabled:t,isInvalid:i,isReadOnly:n,isRequired:o,...r}=s(e);return{...r,disabled:t,readOnly:n,required:o,"aria-invalid":(0,l.Qm)(i),"aria-required":(0,l.Qm)(o),"aria-readonly":(0,l.Qm)(n)}}function s(e){var t,i,o;let s=(0,n.NJ)(),{id:r,disabled:a,readOnly:d,required:c,isRequired:u,isInvalid:h,isReadOnly:f,isDisabled:m,onFocus:p,onBlur:x,...j}=e,g=e["aria-describedby"]?[e["aria-describedby"]]:[];return(null==s?void 0:s.hasFeedbackText)&&(null==s?void 0:s.isInvalid)&&g.push(s.feedbackId),(null==s?void 0:s.hasHelpText)&&g.push(s.helpTextId),{...j,"aria-describedby":g.join(" ")||void 0,id:null!=r?r:null==s?void 0:s.id,isDisabled:null!=(t=null!=a?a:m)?t:null==s?void 0:s.isDisabled,isReadOnly:null!=(i=null!=d?d:f)?i:null==s?void 0:s.isReadOnly,isRequired:null!=(o=null!=c?c:u)?o:null==s?void 0:s.isRequired,isInvalid:null!=h?h:null==s?void 0:s.isInvalid,onFocus:(0,l.v0)(null==s?void 0:s.onFocus,p),onBlur:(0,l.v0)(null==s?void 0:s.onBlur,x)}}},27100:function(e,t,i){"use strict";i.d(t,{NI:function(){return x},NJ:function(){return p},e:function(){return f}});var n=i(310),l=i(45663),o=i(58250),s=i(89839),r=i(50446),a=i(82184),d=i(16465),c=i(2265),u=i(57437),[h,f]=(0,n.k)({name:"FormControlStylesContext",errorMessage:"useFormControlStyles returned is 'undefined'. Seems you forgot to wrap the components in \"<FormControl />\" "}),[m,p]=(0,n.k)({strict:!1,name:"FormControlContext"}),x=(0,o.G)(function(e,t){let i=(0,s.jC)("Form",e),{getRootProps:n,htmlProps:o,...f}=function(e){let{id:t,isRequired:i,isInvalid:n,isDisabled:o,isReadOnly:s,...r}=e,a=(0,c.useId)(),u=t||`field-${a}`,h=`${u}-label`,f=`${u}-feedback`,m=`${u}-helptext`,[p,x]=(0,c.useState)(!1),[j,g]=(0,c.useState)(!1),[v,b]=(0,c.useState)(!1),y=(0,c.useCallback)((e={},t=null)=>({id:m,...e,ref:(0,l.lq)(t,e=>{e&&g(!0)})}),[m]),z=(0,c.useCallback)((e={},t=null)=>({...e,ref:t,"data-focus":(0,d.PB)(v),"data-disabled":(0,d.PB)(o),"data-invalid":(0,d.PB)(n),"data-readonly":(0,d.PB)(s),id:void 0!==e.id?e.id:h,htmlFor:void 0!==e.htmlFor?e.htmlFor:u}),[u,o,v,n,s,h]),k=(0,c.useCallback)((e={},t=null)=>({id:f,...e,ref:(0,l.lq)(t,e=>{e&&x(!0)}),"aria-live":"polite"}),[f]),_=(0,c.useCallback)((e={},t=null)=>({...e,...r,ref:t,role:"group","data-focus":(0,d.PB)(v),"data-disabled":(0,d.PB)(o),"data-invalid":(0,d.PB)(n),"data-readonly":(0,d.PB)(s)}),[r,o,v,n,s]);return{isRequired:!!i,isInvalid:!!n,isReadOnly:!!s,isDisabled:!!o,isFocused:!!v,onFocus:()=>b(!0),onBlur:()=>b(!1),hasFeedbackText:p,setHasFeedbackText:x,hasHelpText:j,setHasHelpText:g,id:u,labelId:h,feedbackId:f,helpTextId:m,htmlProps:r,getHelpTextProps:y,getErrorMessageProps:k,getRootProps:_,getLabelProps:z,getRequiredIndicatorProps:(0,c.useCallback)((e={},t=null)=>({...e,ref:t,role:"presentation","aria-hidden":!0,children:e.children||"*"}),[])}}((0,r.Lr)(e)),p=(0,d.cx)("chakra-form-control",e.className);return(0,u.jsx)(m,{value:f,children:(0,u.jsx)(h,{value:i,children:(0,u.jsx)(a.m.div,{...n({},t),className:p,__css:i.container})})})});x.displayName="FormControl",(0,o.G)(function(e,t){let i=p(),n=f(),l=(0,d.cx)("chakra-form__helper-text",e.className);return(0,u.jsx)(a.m.div,{...null==i?void 0:i.getHelpTextProps(e,t),__css:n.helperText,className:l})}).displayName="FormHelperText"},51091:function(e,t,i){"use strict";i.d(t,{I:function(){return c}});var n=i(6036),l=i(58250),o=i(89839),s=i(50446),r=i(82184),a=i(16465),d=i(57437),c=(0,l.G)(function(e,t){let{htmlSize:i,...l}=e,c=(0,o.jC)("Input",l),u=(0,s.Lr)(l),h=(0,n.Y)(u),f=(0,a.cx)("chakra-input",e.className);return(0,d.jsx)(r.m.input,{size:i,...h,__css:c.field,ref:t,className:f})});c.displayName="Input",c.id="Input"},56641:function(e,t,i){"use strict";i.d(t,{P:function(){return h}});var n=i(16465),l=i(58250),o=i(82184),s=i(57437),r=(0,l.G)(function(e,t){let{children:i,placeholder:l,className:r,...a}=e;return(0,s.jsxs)(o.m.select,{...a,ref:t,className:(0,n.cx)("chakra-select",r),children:[l&&(0,s.jsx)("option",{value:"",children:l}),i]})});r.displayName="SelectField";var a=i(6036),d=i(89839),c=i(50446),u=i(2265),h=(0,l.G)((e,t)=>{var i;let l=(0,d.jC)("Select",e),{rootProps:u,placeholder:h,icon:f,color:m,height:x,h:j,minH:g,minHeight:v,iconColor:b,iconSize:y,...z}=(0,c.Lr)(e),[k,_]=function(e,t){let i={},n={};for(let[l,o]of Object.entries(e))t.includes(l)?i[l]=o:n[l]=o;return[i,n]}(z,c.oE),C=(0,a.Y)(_),S={paddingEnd:"2rem",...l.field,_focus:{zIndex:"unset",...null==(i=l.field)?void 0:i._focus}};return(0,s.jsxs)(o.m.div,{className:"chakra-select__wrapper",__css:{width:"100%",height:"fit-content",position:"relative",color:m},...k,...u,children:[(0,s.jsx)(r,{ref:t,height:null!=j?j:x,minH:null!=g?g:v,placeholder:h,...C,__css:S,children:e.children}),(0,s.jsx)(p,{"data-disabled":(0,n.PB)(C.disabled),...(b||m)&&{color:b||m},__css:l.icon,...y&&{fontSize:y},children:f})]})});h.displayName="Select";var f=e=>(0,s.jsx)("svg",{viewBox:"0 0 24 24",...e,children:(0,s.jsx)("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),m=(0,o.m)("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),p=e=>{let{children:t=(0,s.jsx)(f,{}),...i}=e,n=(0,u.cloneElement)(t,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return(0,s.jsx)(m,{...i,className:"chakra-select__icon-wrapper",children:(0,u.isValidElement)(t)?n:null})};p.displayName="SelectIcon"}},function(e){e.O(0,[9929,6161,8071,4486,2971,4938,1744],function(){return e(e.s=43344)}),_N_E=e.O()}]);